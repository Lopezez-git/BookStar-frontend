<div class="pagina-detalhes">
  <button class="btn-voltar" (click)="voltar()">← Voltar</button>

  <div *ngIf="carregando" class="loading">Carregando...</div>
  <div *ngIf="erro" class="erro">{{ erro }}</div>

  <div *ngIf="!carregando && !erro && livro" class="conteudo">

    <div class="secao-principal">
      <div class="capa-container">
        <img [src]="livro.capa_livro || 'assets/placeholder-book.jpg'" 
             [alt]="livro.titulo" class="capa-livro">
      </div>

      <div class="info-container">
        <h1 class="titulo-livro">{{ livro.titulo }}</h1>

        <div class="status-icons">
          <button class="icon-btn" [class.active]="statusLocal === 'quero ler'" 
                  (click)="marcarStatus('quero ler')" title="Quero Ler">
            <img src="olho.png" alt="Quero Ler" class="icon-img">
            <span>{{ statusLocal === 'quero ler' ? 'Quero Ler ✓' : 'Quero Ler' }}</span>
          </button>

          <button class="icon-btn" [class.active]="statusLocal === 'estou lendo'" 
                  (click)="marcarStatus('estou lendo')" title="Estou Lendo">
            <img src="coracao (1).png" alt="Estou Lendo" class="icon-img">
            <span>{{ statusLocal === 'estou lendo' ? 'Estou Lendo ✓' : 'Estou Lendo' }}</span>
          </button>

          <button class="icon-btn" [class.active]="statusLocal === 'concluido'" 
                  (click)="marcarStatus('concluido')" title="Concluído">
            <img src="relogio-tres.png" alt="Concluído" class="icon-img">
            <span>{{ statusLocal === 'concluido' ? 'Concluído ✓' : 'Marcar Concluído' }}</span>
          </button>
        </div>

        <div class="avaliacao-section">
          <h3>Sua Avaliação</h3>
          <div class="estrelas">
            <span *ngFor="let star of getRatingArray()" 
                  class="estrela" 
                  [class.filled]="star <= (hoverRating || avaliacaoUsuario)"
                  (click)="setRating(star)"
                  (mouseenter)="setHoverRating(star)"
                  (mouseleave)="resetHoverRating()">
              ★
            </span>
          </div>
        </div>

        <div class="descricao-section">
          <h3>Sobre o Livro</h3>
          <p class="descricao">{{ livro.descricao }}</p>
        </div>
      </div>
    </div>

    <div class="secao-comentario">
      <h3>Seu Comentário</h3>
      <textarea [(ngModel)]="comentarioUsuario"
                placeholder="Escreva seu comentário aqui..."
                rows="5"
                class="comentario-input"></textarea>
      <button class="btn-salvar" (click)="atualizarLivroNoBanco()">Salvar Alterações</button>
    </div>

    <div class="secao-autor">
      <h2>Sobre o Autor</h2>
      <div class="autor-info">
        <div class="autor-foto">
          <img class="autor-foto" [src]="livro.foto_autor" alt="">
        </div>
        <div class="autor-texto">
          <h3>{{ livro.autor }}</h3>
          <p class="autor-bio">{{ livro.biografiaAutor }}</p>
        </div>
      </div>
    </div>

  </div>
</div>